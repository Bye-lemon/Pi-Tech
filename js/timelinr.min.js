jQuery.fn.timelinr=function(a){settings=jQuery.extend({orientation:"horizontal",containerDiv:"#timeline",datesDiv:"#dates",datesSelectedClass:"selected",datesSpeed:"normal",issuesDiv:"#issues",issuesSelectedClass:"selected",issuesSpeed:"fast",issuesTransparency:0.2,issuesTransparencySpeed:500,prevButton:"#prev",nextButton:"#next",arrowKeys:"false",startAt:1,autoPlay:"true",autoPlayDirection:"forward",autoPlayPause:2000},a);$(function(){if($(settings.datesDiv).length>0&&$(settings.issuesDiv).length>0){var k=$(settings.datesDiv+" li").length;var g=$(settings.issuesDiv+" li").length;var e=$(settings.datesDiv).find("a."+settings.datesSelectedClass);var o=$(settings.issuesDiv).find("li."+settings.issuesSelectedClass);var h=$(settings.containerDiv).width();var j=$(settings.containerDiv).height();var i=$(settings.issuesDiv).width();var f=$(settings.issuesDiv).height();var n=$(settings.issuesDiv+" li").width();var l=$(settings.issuesDiv+" li").height();var d=$(settings.datesDiv).width();var b=$(settings.datesDiv).height();var p=$(settings.datesDiv+" li").width();var m=$(settings.datesDiv+" li").height();if(settings.orientation=="horizontal"){$(settings.issuesDiv).width(n*g);$(settings.datesDiv).width(p*k).css("marginLeft",h/2-p/2);var q=parseInt($(settings.datesDiv).css("marginLeft").substring(0,$(settings.datesDiv).css("marginLeft").indexOf("px")))}else{if(settings.orientation=="vertical"){$(settings.issuesDiv).height(l*g);$(settings.datesDiv).height(m*k).css("marginTop",j/2-m/2);var q=parseInt($(settings.datesDiv).css("marginTop").substring(0,$(settings.datesDiv).css("marginTop").indexOf("px")))}}$(settings.datesDiv+" a").click(function(s){s.preventDefault();var t=$(this).text();var r=$(this).parent().prevAll().length;if(settings.orientation=="horizontal"){$(settings.issuesDiv).animate({marginLeft:-n*r},{queue:false,duration:settings.issuesSpeed})}else{if(settings.orientation=="vertical"){$(settings.issuesDiv).animate({marginTop:-l*r},{queue:false,duration:settings.issuesSpeed})}}$(settings.issuesDiv+" li").animate({opacity:settings.issuesTransparency},{queue:false,duration:settings.issuesSpeed}).removeClass(settings.issuesSelectedClass).eq(r).addClass(settings.issuesSelectedClass).fadeTo(settings.issuesTransparencySpeed,1);if(k==1){$(settings.prevButton+","+settings.nextButton).fadeOut("fast")}else{if(k==2){if($(settings.issuesDiv+" li:first-child").hasClass(settings.issuesSelectedClass)){$(settings.prevButton).fadeOut("fast");$(settings.nextButton).fadeIn("fast")}else{if($(settings.issuesDiv+" li:last-child").hasClass(settings.issuesSelectedClass)){$(settings.nextButton).fadeOut("fast");$(settings.prevButton).fadeIn("fast")}}}else{if($(settings.issuesDiv+" li:first-child").hasClass(settings.issuesSelectedClass)){$(settings.nextButton).fadeIn("fast");$(settings.prevButton).fadeOut("fast")}else{if($(settings.issuesDiv+" li:last-child").hasClass(settings.issuesSelectedClass)){$(settings.prevButton).fadeIn("fast");$(settings.nextButton).fadeOut("fast")}else{$(settings.nextButton+","+settings.prevButton).fadeIn("slow")}}}}$(settings.datesDiv+" a").removeClass(settings.datesSelectedClass);$(this).addClass(settings.datesSelectedClass);if(settings.orientation=="horizontal"){$(settings.datesDiv).animate({marginLeft:q-(p*r)},{queue:false,duration:"settings.datesSpeed"})}else{if(settings.orientation=="vertical"){$(settings.datesDiv).animate({marginTop:q-(m*r)},{queue:false,duration:"settings.datesSpeed"})}}});$(settings.nextButton).bind("click",function(s){s.preventDefault();var r=$(settings.issuesDiv).find("li."+settings.issuesSelectedClass).index();if(settings.orientation=="horizontal"){var w=parseInt($(settings.issuesDiv).css("marginLeft").substring(0,$(settings.issuesDiv).css("marginLeft").indexOf("px")));var v=w/n;var t=parseInt($(settings.datesDiv).css("marginLeft").substring(0,$(settings.datesDiv).css("marginLeft").indexOf("px")));var u=t-p;if(w<=-(n*g-(n))){$(settings.issuesDiv).stop();$(settings.datesDiv+" li:last-child a").click()}else{if(!$(settings.issuesDiv).is(":animated")){$(settings.datesDiv+" li").eq(r+1).find("a").trigger("click")}}}else{if(settings.orientation=="vertical"){var w=parseInt($(settings.issuesDiv).css("marginTop").substring(0,$(settings.issuesDiv).css("marginTop").indexOf("px")));var v=w/l;var t=parseInt($(settings.datesDiv).css("marginTop").substring(0,$(settings.datesDiv).css("marginTop").indexOf("px")));var u=t-m;if(w<=-(l*g-(l))){$(settings.issuesDiv).stop();$(settings.datesDiv+" li:last-child a").click()}else{if(!$(settings.issuesDiv).is(":animated")){$(settings.datesDiv+" li").eq(r+1).find("a").trigger("click")}}}}if(k==1){$(settings.prevButton+","+settings.nextButton).fadeOut("fast")}else{if(k==2){if($(settings.issuesDiv+" li:first-child").hasClass(settings.issuesSelectedClass)){$(settings.prevButton).fadeOut("fast");$(settings.nextButton).fadeIn("fast")}else{if($(settings.issuesDiv+" li:last-child").hasClass(settings.issuesSelectedClass)){$(settings.nextButton).fadeOut("fast");$(settings.prevButton).fadeIn("fast")}}}else{if($(settings.issuesDiv+" li:first-child").hasClass(settings.issuesSelectedClass)){$(settings.prevButton).fadeOut("fast")}else{if($(settings.issuesDiv+" li:last-child").hasClass(settings.issuesSelectedClass)){$(settings.nextButton).fadeOut("fast")}else{$(settings.nextButton+","+settings.prevButton).fadeIn("slow")}}}}});$(settings.prevButton).click(function(s){s.preventDefault();var r=$(settings.issuesDiv).find("li."+settings.issuesSelectedClass).index();if(settings.orientation=="horizontal"){var w=parseInt($(settings.issuesDiv).css("marginLeft").substring(0,$(settings.issuesDiv).css("marginLeft").indexOf("px")));var v=w/n;var t=parseInt($(settings.datesDiv).css("marginLeft").substring(0,$(settings.datesDiv).css("marginLeft").indexOf("px")));var u=t+p;if(w>=0){$(settings.issuesDiv).stop();$(settings.datesDiv+" li:first-child a").click()}else{if(!$(settings.issuesDiv).is(":animated")){$(settings.datesDiv+" li").eq(r-1).find("a").trigger("click")}}}else{if(settings.orientation=="vertical"){var w=parseInt($(settings.issuesDiv).css("marginTop").substring(0,$(settings.issuesDiv).css("marginTop").indexOf("px")));var v=w/l;var t=parseInt($(settings.datesDiv).css("marginTop").substring(0,$(settings.datesDiv).css("marginTop").indexOf("px")));var u=t+m;if(w>=0){$(settings.issuesDiv).stop();$(settings.datesDiv+" li:first-child a").click()}else{if(!$(settings.issuesDiv).is(":animated")){$(settings.datesDiv+" li").eq(r-1).find("a").trigger("click")}}}}if(k==1){$(settings.prevButton+","+settings.nextButton).fadeOut("fast")}else{if(k==2){if($(settings.issuesDiv+" li:first-child").hasClass(settings.issuesSelectedClass)){$(settings.prevButton).fadeOut("fast");$(settings.nextButton).fadeIn("fast")}else{if($(settings.issuesDiv+" li:last-child").hasClass(settings.issuesSelectedClass)){$(settings.nextButton).fadeOut("fast");$(settings.prevButton).fadeIn("fast")}}}else{if($(settings.issuesDiv+" li:first-child").hasClass(settings.issuesSelectedClass)){$(settings.prevButton).fadeOut("fast")}else{if($(settings.issuesDiv+" li:last-child").hasClass(settings.issuesSelectedClass)){$(settings.nextButton).fadeOut("fast")}else{$(settings.nextButton+","+settings.prevButton).fadeIn("slow")}}}}});if(settings.arrowKeys=="true"){if(settings.orientation=="horizontal"){$(document).keydown(function(r){if(r.keyCode==39){$(settings.nextButton).click()}if(r.keyCode==37){$(settings.prevButton).click()}})}else{if(settings.orientation=="vertical"){$(document).keydown(function(r){if(r.keyCode==40){$(settings.nextButton).click()}if(r.keyCode==38){$(settings.prevButton).click()}})}}}$(settings.datesDiv+" li").eq(settings.startAt-1).find("a").trigger("click");if(settings.autoPlay=="true"){var c=setInterval(autoPlay,settings.autoPlayPause);$(settings.containerDiv).hover(function(r){clearInterval(c)},function(r){c=setInterval(autoPlay,settings.autoPlayPause)})}}})};function autoPlay(){var a=$(settings.datesDiv).find("a."+settings.datesSelectedClass);if(settings.autoPlayDirection=="forward"){if(a.parent().is("li:last-child")){$(settings.datesDiv+" li:first-child").find("a").trigger("click")}else{a.parent().next().find("a").trigger("click")}}else{if(settings.autoPlayDirection=="backward"){if(a.parent().is("li:first-child")){$(settings.datesDiv+" li:last-child").find("a").trigger("click")}else{a.parent().prev().find("a").trigger("click")}}}};